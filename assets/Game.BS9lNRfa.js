import{m as E,u as L,j as o,B as j,A}from"./SocialIcon.UXpolBIf.js";import{R as d}from"./index.B52nOzfP.js";import{d as b,t as h}from"./Toast.Store.DAqCFVQo.js";const T=5,v=6,p=10;let S=(e,t,s,r)=>(e.events=e.events||{},e.events[s+p]||(e.events[s+p]=r(i=>{e.events[s].reduceRight((n,c)=>(c(n),n),{shared:{},...i})})),e.events[s]=e.events[s]||[],e.events[s].push(t),()=>{let i=e.events[s],n=i.indexOf(t);i.splice(n,1),i.length||(delete e.events[s],e.events[s+p](),delete e.events[s+p])}),C=1e3,M=(e,t)=>S(e,r=>{let i=t(r);i&&e.events[v].push(i)},T,r=>{let i=e.listen;e.listen=(...c)=>(!e.lc&&!e.active&&(e.active=!0,r()),i(...c));let n=e.off;return e.events[v]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let c of e.events[v])c();e.events[v]=[]}},C)},()=>{e.listen=i,e.off=n}});const w=E({tries:6,length:5,lang:"es"}),O=(e,t)=>{const s=typeof t=="string"?t:JSON.stringify(t);localStorage.setItem(e,s)},I=e=>{const t=localStorage.getItem(e);if(!t)return{};try{return JSON.parse(t)}catch(s){return console.error("Error parsing JSON from localStorage:",s),t}},B=e=>{if(!localStorage.getItem(e)){console.log("Storage not found");return}localStorage.removeItem(e)},G=e=>JSON.parse(JSON.stringify(e)),U=e=>JSON.parse(e),V=e=>JSON.stringify(e),m={set:O,get:I,remove:B,inmutable:G,parse:U,stringify:V},P=(e,t)=>{let s=Array(e.length).fill("false"),r={};e.split("").forEach(n=>{r[n]=(r[n]||0)+1});for(let n=0;n<e.length;n++)t[n]===e[n]&&(s[n]="true",r[t[n]]-=1);for(let n=0;n<e.length;n++)s[n]==="false"&&r[t[n]]>0&&(s[n]="exist",r[t[n]]-=1);const i=s.every(n=>n==="true");return{result:s,isWin:i}},D={compareWord:P},y=async(e,t,s)=>{const r=await fetch(`/api/${e}/${t}/${s}`);if(!r.ok)throw new Error(`Error ${r.status}: No se pudo obtener las palabras`);return await r.json()},J=async()=>{const e=w.get(),t=await y("game",e.lang,e.length),s=Math.floor(Math.random()*(t.length+1));a.setKey("word",t[s]),m.set("guessword",{game:a.get(),setting:e})},K=async e=>{const t=w.get();return(await y("dic",t.lang,t.length)).includes(e.toLowerCase())},R={getWord:J,getByLangLength:y,existWord:K},Y=typeof window<"u",x={word:"",guess:"",valid:Array.from({length:6},()=>Array.from({length:5},()=>({letter:"",state:void 0}))),currentRow:0,currentLetter:0,isWin:void 0,restart:!1},a=b(Y&&m.get("guessword").game||x),f=w.get();M(a,()=>{a.get().word===""&&R.getWord()});const _=e=>{const t=a.get();if(t.currentLetter>=f.length||t.isWin||t.currentRow>=f.tries)return;const s=t.valid[t.currentRow][t.currentLetter];s.letter=e,s.state=void 0,a.setKey("currentLetter",t.currentLetter+1)},q=()=>{const e=a.get();if(e.currentLetter<=0||e.isWin||e.currentRow>=e.valid.length)return;const t=[...e.valid],s=e.currentLetter-1,i=e.valid[e.currentRow][e.currentLetter]?.letter?e.currentLetter:s;i<0||(t[e.currentRow][i]={letter:"",state:void 0},a.set({...e,currentLetter:i,valid:t}))},H=async()=>{const e={...a.get()};if(e.isWin||e.currentRow>e.valid.length-1)return;const t=e.valid[e.currentRow].every(u=>u.letter),s=document.querySelector(`[data-row="${e.currentRow}"]`),r=u=>{s?.classList.add("error"),h.error(u),setTimeout(()=>{s?.classList.remove("error")},400)};if(!t){r("Field is not complete");return}h.dismiss();const i=e.valid[e.currentRow].map(u=>u.letter).join("");if(!await R.existWord(i)){r("Invalid word");return}const c=D.compareWord(e.word.toUpperCase(),i.toUpperCase());if(c.result.forEach((u,N)=>{e.valid[e.currentRow][N].state=u}),c.isWin){a.setKey("isWin",!0),m.set("guessword",{game:a.get(),setting:f});return}else if(e.currentRow===e.valid.length-1){a.setKey("isWin",!1),h.show(e.word),m.set("guessword",{game:a.get(),setting:f});return}e.currentLetter=0,e.currentRow=e.currentRow+1,e.guess="",a.set(e),m.set("guessword",{game:e,setting:f})},Z=()=>{const e={...x,valid:Array.from({length:f.tries},()=>Array.from({length:f.length},()=>({letter:"",state:void 0})))};a.set(e),document.querySelectorAll(".key-box").forEach(s=>s.removeAttribute("data-valid"))},l={typing:_,backspace:q,enter:H,restart:Z};function F({data:e,index:t,currentLetter:s,currentRow:r}){const i=L(a),n=d.useRef(null);return["game-box d-flex br-4 f-center",s===t&&"target",e.letter&&"active"].filter(Boolean).join(" "),d.useEffect(()=>{e.state!==void 0?(n?.current?.removeAttribute("data-valid"),n?.current?.removeAttribute("data-win"),n.current?.classList.remove("active"),setTimeout(()=>{n?.current?.classList.add("validate"),setTimeout(()=>{n.current?.setAttribute("data-valid",`${e.state}`),i.isWin&&i.currentRow===r&&setTimeout(()=>{n.current?.setAttribute("data-win","true")},(i?.valid[0].length+1)*120)},200)},t*210)):(n.current?.classList.remove("active"),n.current?.removeAttribute("data-valid"),n.current?.removeAttribute("data-win"))},[e.state]),o.jsx("span",{className:`game-box d-flex br-4 f-center ${s===t?"target":""} ${e.letter?"active":""}`,"data-valid":e.state,style:{pointerEvents:i.isWin!==void 0?"none":"visible",cursor:i.currentRow===r?"pointer":"default"},onClick:()=>{i.isWin===void 0&&i.currentRow===r&&a.setKey("currentLetter",t)},ref:n,children:e.letter})}function z({data:e,currentLetter:t,currentRow:s,index:r}){return o.jsx("div",{className:"f-row g-2 f-center","data-row":r,children:e?.map((i,n)=>o.jsx(F,{data:i,index:n,currentLetter:s===r?t:null,currentRow:r},n))})}const Q={send:o.jsx("svg",{height:30,viewBox:"0 -1 24 24",fill:"none",children:o.jsxs("g",{children:[" ",o.jsx("path",{d:"M7 12L9.89075 14.8907V14.8907C9.95114 14.951 10.049 14.9511 10.1094 14.8907V14.8907L17 8",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})," "]})}),backspace:o.jsx("svg",{height:26,viewBox:"0 -1 24 24",fill:"none",children:o.jsxs("g",{children:[o.jsx("path",{d:"M7.91987 5C7.33602 5 6.78132 5.25513 6.40136 5.69842L2.11564 10.6984C1.47366 11.4474 1.47366 12.5526 2.11564 13.3016L6.40136 18.3016C6.78132 18.7449 7.33602 19 7.91987 19L19 19C20.1046 19 21 18.1046 21 17L21 7C21 5.89543 20.1046 5 19 5L7.91987 5Z",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.8"}),o.jsx("path",{d:"M15 10.0001L11 14.0001",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),o.jsx("path",{d:"M11 10.0001L15 14.0001",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]})})};function W({id:e}){return Q[`${e}`]}function X(){const e=L(a),[t,s]=d.useState(!1);return d.useEffect(()=>{s(!1),e.isWin!==void 0&&setTimeout(()=>{s(!0)},e.valid[0].length*250)},[e.isWin]),d.useEffect(()=>{e.currentRow>0&&e.currentRow<=e.valid.length&&setTimeout(()=>{for(let r=0;r<e.currentRow;r++)e.valid[r].forEach(n=>{const c=document.querySelector(`[data-letter="${n.letter.toUpperCase()}"]`);c?.getAttribute("data-valid")!=="true"&&c?.setAttribute("data-valid",n.state)})},e.valid[0].length*260)},[e.currentRow]),o.jsxs("section",{className:"f-col w-100 relative mt-3",children:[o.jsxs("div",{className:"keyboard-container f-col g-2",children:[o.jsx("div",{className:"f-row g-2",children:"QWERTYUIOP".split("").map((r,i)=>o.jsx(g,{content:r,onPointer:()=>l.typing(r)},i))}),o.jsxs("div",{className:"f-row g-2",children:["ASDFGHJKL".split("").map((r,i)=>o.jsx(g,{content:r,onPointer:()=>l.typing(r)},i)),o.jsx(g,{className:"icon",content:o.jsx(W,{id:"backspace"}),onPointer:()=>l.backspace()})]}),o.jsxs("div",{className:"f-row g-2",children:[`${w.get().lang==="es"?"Ã‘":""}ZXCVBNM`.split("").map((r,i)=>o.jsx(g,{content:r,onPointer:()=>l.typing(r)},i)),o.jsx(g,{className:"icon",content:o.jsx(W,{id:"send"}),onPointer:()=>l.enter()})]})]}),o.jsx("div",{className:`play-again absolute d-flex f-center h-100 w-100 ${t?"active":""}`,children:o.jsx(j,{className:"btn btn-primary br-6",text:"Play Again",onClick:async()=>{await new Promise(r=>setTimeout(r,450)),R.getWord(),l.restart()}})})]})}const g=({content:e,onPointer:t,className:s})=>o.jsx("span",{className:`key-box br-4 d-flex f-center pointer fw-500 fs-custom-14-5 ${s||""}`,onClick:t,"data-letter":e,children:e});E({user:"",token:"",firebaseAuth:{uid:"",isAuth:!1}});function k({props:e}){return console.log(e),o.jsx("div",{className:"game-popup p-2 br-8 f-col g-2",children:"Hola mundo dese un Dialog"})}function re(){const e=L(a);let t=e.valid;const s=r=>{const i=/^[a-zA-Z]$/;e.isWin||e.isWin===!1||e.currentRow===e.valid.length-1||(i.test(r.key)?l.typing(r.key):r.key==="Backspace"?l.backspace():r.key==="Enter"?l.enter():r.key==="ArrowLeft"?a.setKey("currentLetter",a.get().currentLetter-1):r.key==="ArrowRight"&&a.setKey("currentLetter",a.get().currentLetter+1))};return d.useEffect(()=>(window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}),[]),d.useEffect(()=>{e.isWin!==void 0&&setTimeout(()=>{e.isWin===!0&&A.custom(o.jsx(k,{}),{state:!0,bgClose:!0}),e.isWin===!1&&A.custom(o.jsx(k,{}),{state:!0,bgClose:!0})},e.valid[0].length*250)},[e.isWin]),o.jsxs("div",{className:"game-board f-col g-2 f-center w-min mx-auto mt-3",style:{pointerEvents:e.isWin!==void 0?"none":"visible"},children:[t?.map((r,i)=>o.jsx(z,{data:r,currentLetter:e.currentLetter,currentRow:e.currentRow,index:i},i)),o.jsx(X,{})]})}export{re as default};
