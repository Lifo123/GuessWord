import{a as y,G as l,u as c,j as n}from"./Buttons.C2RI7U2N.js";import{r as d}from"./index.YZ_XhM9s.js";import{J as N}from"./_astro-entry_sonner.BrdQ6kbN.js";/* empty css                        */import"./index.CTAGWh-w.js";const G=(e,s)=>{localStorage.setItem(e,JSON.stringify(s))},R=e=>JSON.parse(localStorage.getItem(e)||"{}"),P=e=>{if(!localStorage.getItem(e)){console.log("Storage not found");return}localStorage.removeItem(e)},V=e=>JSON.parse(JSON.stringify(e)),u={set:G,get:R,remove:P,inmutable:V},S=typeof window<"u",C=y(S?JSON.parse(localStorage.getItem("F-Config")||"{}"):{}),$=y(S&&new URLSearchParams(window.location.search).get("data")||""),w=y({popup:{type:null,delay:null}}),b={Config:C,Params:$},F=e=>Math.floor(Math.random()*((e||100)+1)),M=(e,s)=>{let t=Array(e.length).fill("false"),a={};e.split("").forEach(r=>{a[r]=(a[r]||0)+1});for(let r=0;r<e.length;r++)s[r]===e[r]&&(t[r]="true",a[s[r]]-=1);for(let r=0;r<e.length;r++)t[r]==="false"&&a[s[r]]>0&&(t[r]="exists",a[s[r]]-=1);const i=t.every(r=>r==="true");return{result:t,isWin:i}},D=(e,s)=>{const t=e.split(":"),a=u.inmutable(s),i=Array.from({length:parseInt(t[1])},()=>Array.from({length:parseInt(t[2])},()=>({char:"",isValid:null})));return a.game.word=t[0],a.game.valid=i,a.settings.tries=parseInt(t[1]),a.settings.length=parseInt(t[2]),a.settings.lang=t[3],a.settings.dictionary=t[4],a},U=(e,s)=>{setTimeout(()=>{if(e==="res"){w.set({popup:{type:null,delay:0}});return}const t=u.inmutable(w.value);t.popup.type=e,t.popup.delay=s,w.set(t)},(s||0)*360)},O=(e,s)=>{let t=l.stadistic.get();e?(t.streak++,t.win++,t.rows[s]++):t.streak=0,t.total++,console.log(t)},v={generateRandom:F,compareWord:M,setParams:D,popup:U,stadistic:O},h={Local:u,utils:v},L=e=>{(e.endsWith("/")||e.endsWith(","))&&(e=e.slice(0,-1));let s=e.split("/").filter(t=>t!=="");if(s.length===0)throw new Error("Invalid Path: No Path encounter");return s=s.map(t=>t.replace(/^[^a-zA-Z0-9-_\,]+|[^a-zA-Z0-9-_\,]+$/g,"")),s},B=(e,s)=>{if(Array.isArray(s))throw new Error("Invalid Format: The object is an array");const t=L(e);for(let i=0;i<t.length-1;i++)if(t[i].includes(","))throw new Error("Invalid Path: The path contains a comma");let a=t[t.length-1];return{Navigation:t,firstPath:t[0],lastPath:a,lastValues:a.split(",")}},j={normalizePath:L,validatePath:B},J=(e,s)=>{const t=j.validatePath(e,s);if(t.lastValues.length>1)throw new Error("The last path expect a single value.");if(t.Navigation.length===1)return s[t.firstPath];let a=s;for(let r=0;r<t.Navigation.length-1;r++){const o=t.Navigation[r];if(!a[o])return;a=a[o]}const i=t.lastPath[0];if(a[i]!==void 0)return a[i]},K=(e,{value:s,data:t})=>{if(s===t)throw new Error("The value and data cannot be the same.");const a=j.validatePath(e,t),i=a.lastValues.length>1;let r=isNaN(Number(a.firstPath))?{...t}:[];if(a.Navigation.length===1)return r[a.firstPath]=s,r;if(!Array.isArray(s)&&a.lastValues.length>1)throw new Error(`The value expects an Array with ${a.lastValues.length} values.`);let o=r,g=o;for(let m=0;m<a.Navigation.length;m++){const p=a.Navigation[m];if(m===a.Navigation.length-1){if(!Array.isArray(s)&&i)throw new Error("The value must be an array when assigning to multiple keys.");if(a.lastValues.length===1){o[p]=s;break}return g=o,a.lastValues.forEach((k,I)=>{g[k]=s[I]}),r}o[p]===void 0&&(o[p]={}),g=o,o=o[p]}return r},Y=(e,s)=>{const t=j.validatePath(e,s);let a={...s};if(t.Navigation.length===1){const{[t.firstPath]:r,...o}=s;return o}let i=s;for(let r=0;r<t.Navigation.length;r++){const o=t.Navigation[r];if(!i[o])return console.log("No existe"),s;if(r===t.Navigation.length-1){delete i[o];break}i=i[o]}return a},q=()=>{console.log("hi")},z=()=>{console.log("goodbye")},W={get:J,set:K,remove:Y,sayHello:q,sayGoodbye:z},H=e=>{const s=u.inmutable(l.game.get());if(s?.restart||s?.isWin!==null)return;const t=s.currentLetter,a=s.currentRow;if(t>=s.valid[0].length)return;let i=W.set(`valid/${a}/${t}/char`,{value:e,data:s});i.currentLetter=t+1,l.game.set(i)},Z=()=>{const e=u.inmutable(l.game.get());if(e?.restart||e?.isWin!==null)return;const s=e.currentLetter,t=e.currentRow;if(s<=0)return;let a=W.set(`valid/${t}/${s-1}/char`,{value:"",data:e});a.currentLetter=s-1,l.game.set(a)},_=()=>{let e=u.inmutable(l.game.get());if(e?.restart)return;const s=e.currentLetter,t=e.currentRow;if(s<e.valid[0].length){const r=document.querySelector(`[data-row="${t}"]`);r?.classList.add("error"),N.error("Field is not complete"),setTimeout(()=>{r?.classList.remove("error")},400);return}N.dismiss();const a=e.valid[t].map(r=>r.char).join(""),i=h.utils.compareWord(e.word.toUpperCase(),a.toUpperCase());for(let r=0;r<e.valid[t].length;r++)e.valid[t][r].isValid=i.result[r];e.currentRow=t+1,e.currentLetter=0,e.isWin=i?.isWin?i?.isWin:null,e.currentRow===e.valid.length&&e.isWin===null&&(e.isWin=!1,v.popup("lose",e.valid.length),setTimeout(()=>{N(e.word,{duration:1500})},e.valid.length*150)),l.game.set(e),h.Local.set("F-Wordle",{game:e,settings:l.setting.get(),visual:l.visual.get(),stadistic:l.stadistic.get()}),e.isWin&&v.popup("win",e.valid.length+1),e.isWin?v.stadistic(!0,e.currentRow-1):e.isWin===!1&&v.stadistic(!1,e.currentRow-1)},f={typing:H,backspace:Z,enter:_},Q=async()=>{try{let e=l.initialData;if(b.Params.get()){e=h.utils.setParams(b.Params.get(),e),l.game.set(e.game),l.setting.set(e.settings),h.Local.set("F-Wordle",e);return}const t=await(await fetch("https://app-eqlfk354ea-uc.a.run.app/word/")).json();return h.Local.set("F-Wordle",{game:{word:t,valid:Array(e.settings.tries).fill(Array(e.settings.length).fill({char:"",isValid:null})),currentRow:0,currentLetter:0,isWin:null,restart:!1},settings:l.setting.get(),visual:l.visual.get(),stadistic:l.stadistic.get()}),l.game.set({...l.game.get(),word:t}),t}catch(e){return console.log(e),null}},A={getWord:Q};function X(){const e=c(l.game),s=c(l.setting),t=async()=>{let i=h.Local.inmutable(l.initialData),r=l.stadistic.get();const o=A.getWord();await N.promise(o,{loading:"Cargando...",error:"Error al cargar la palabra"});const g=await o;i.game.word=g,i.game.restart=!1,i.game.isWin=null,i.game.valid=Array(s.tries).fill(Array(s.length).fill({char:"",isValid:null})),i.settings.tries=s.tries,i.stadistic=r,l.game.set(i.game),h.Local.set("F-Wordle",i),v.popup("res",0),document.querySelectorAll("[data-char]").forEach(p=>{p.removeAttribute("data-valid")})},a=i=>{/^[a-zA-ZñÑ]$/.test(i.key)&&f.typing(i.key),i.key==="Backspace"&&f.backspace(),i.key==="Enter"&&f.enter()};return d.useEffect(()=>(e?.isWin||e?.currentRow===e?.valid.length||e?.restart?window?.removeEventListener("keydown",a):window?.addEventListener("keydown",a),()=>{window?.removeEventListener("keydown",a)}),[e?.isWin,e?.restart]),d.useEffect(()=>{h.Local.get("F-Wordle")?.game?.word||A.getWord()},[]),{restartGame:t}}function ee({data:e,id:s}){const t=c(l.game),a=d.useRef(null);return d.useEffect(()=>{e.isValid!==null?(a?.current?.removeAttribute("data-valid"),a?.current?.removeAttribute("data-win"),a?.current?.classList.remove("active"),setTimeout(()=>{a?.current?.classList.add("validate"),setTimeout(()=>{a.current?.setAttribute("data-valid",e.isValid),t.isWin&&setTimeout(()=>{a.current?.setAttribute("data-win","true")},(t?.valid[0].length+1)*60)},180)},s*210)):(a.current?.classList.remove("validate"),a.current?.removeAttribute("data-valid"),a.current?.removeAttribute("data-win"))},[e.isValid,e.char]),n.jsx("span",{className:`box-letter ${e.char?"active":""}`,ref:a,children:e?.char?.toUpperCase()||""})}function te({row:e=[],id:s}){return n.jsx("div",{className:"game-row f-row g-2 f-center","data-row":s,children:e?.map((t,a)=>n.jsx(ee,{data:t,id:a},`${t.char}-${a}`))})}function se(){const e=c(l.stadistic),s=c(l.setting);return n.jsxs("div",{className:"stadistic-container br-4 f-col pt-2 px-3 pb-3 w-100",children:[n.jsxs("div",{className:"f-row g-2 f-center mb-2",children:[n.jsx("p",{children:e?.total}),n.jsx("p",{children:e?.win}),n.jsx("p",{children:e?.total-e?.win}),n.jsx("p",{children:e?.streak})]}),n.jsx("div",{className:"f-col g-1 w-100",children:e?.rows.slice(0,s.tries).map((t,a)=>n.jsx("span",{children:t},a))})]})}function ae({funct:e=()=>console.log("Sin funcion")}){const[s,t]=d.useState(!1),a=c(l.game),{popup:i}=c(w),r=a.isWin,o={title:r?"!Felicidades!":"!Perdiste!",desc:r?"Has ganado la palabra":"No has ganado la palabra",btntext:r?"Jugar de nuevo":"Volver a intentarlo",btnsec:r,delay:i?.delay||(a.valid[0]?.length+1)*360,cont:r?n.jsx(se,{}):null};return d.useEffect(()=>{if(r||!r){const g=setTimeout(()=>{t(!0)},o.delay);return()=>clearTimeout(g)}},[r,o.delay]),d.useEffect(()=>{s?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[s]),s?n.jsx("div",{className:"obscure absolute h-100 w-100 d-flex fixed",children:n.jsx("div",{className:"wrapper-play-again absolute d-flex f-justify-center",children:n.jsxs("div",{className:"play-again-container f-col g-2 br-10 px-3 py-4 f-align-center",style:{marginTop:r?"12vh":"16vh"},children:[n.jsx("h1",{children:o.title}),n.jsx("p",{children:o.desc}),o.cont&&n.jsx("div",{className:"f-col g-2 w-100 f-center",children:o.cont}),n.jsxs("div",{className:"f-row g-2 w-100 f-center mt-3",children:[n.jsx("span",{className:"btn btn-green br-6 d-flex f-center",onClick:e,children:o.btntext}),o.btnsec&&n.jsx("span",{className:"btn btn-blue br-6 d-flex f-center",children:"Compartir"})]})]})})}):null}function ne(){return n.jsx("span",{className:"icon",children:n.jsx("svg",{width:"28",height:"28",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",style:{rotate:"-90deg",transform:"translate(0px, -2px)"},children:n.jsx("path",{d:"m10 11.5 4 4m0-4-4 4M6.133 21C4.955 21 4 20.02 4 18.81v-8.802c0-.665.295-1.295.8-1.71l5.867-4.818a2.09 2.09 0 0 1 2.666 0l5.866 4.818c.506.415.801 1.045.801 1.71v8.802c0 1.21-.955 2.19-2.133 2.19z"})})})}function re(){const e=c(l.game);return d.useEffect(()=>{e.currentRow>0&&e.currentRow<=e.valid.length&&setTimeout(()=>{for(let s=0;s<e.currentRow;s++)e.valid[s].forEach((a,i)=>{const r=document.querySelector(`[data-char="${a.char.toUpperCase()}"]`);r?.getAttribute("data-valid")!=="true"&&r?.setAttribute("data-valid",a.isValid)})},e.valid[0].length*260)},[e.currentRow]),n.jsxs("section",{className:"keyboard-container f-col g-2 mt-4",children:[n.jsx("div",{className:"f-row g-2",children:"QWERTYUIOP".split("").map((s,t)=>n.jsx(x,{char:s,funct:()=>f.typing(s)},t))}),n.jsx("div",{className:"f-row g-2",children:"ASDFGHJKL".split("").map((s,t)=>n.jsx(x,{char:s,funct:()=>f.typing(s)},t))}),n.jsxs("div",{className:"f-row g-2",children:[n.jsx(x,{char:"Enviar",className:"px-5",funct:()=>f.enter()}),"ZXCVBNM".split("").map((s,t)=>n.jsx(x,{char:s,funct:()=>f.typing(s)},t)),n.jsx(x,{className:"px-4",char:n.jsx(ne,{}),funct:()=>f.backspace()})]})]})}const x=e=>n.jsx("span",{className:`keyboard-box pointer d-flex f-center br-4 ${e.className||""}`,style:e.style,onClick:e.funct,"data-char":e.char,children:e.char});function ie(){const e=c(l.game);c(l.setting),c(w);const s=X();return n.jsxs("div",{className:"board f-col g-2 f-center h-100 w-100 relative pb-5",children:[e?.isWin!==null?n.jsx(ae,{funct:s.restartGame}):null,n.jsx("div",{className:"board-cont f-col g-2",children:e?.valid?.map((t,a)=>n.jsx(te,{id:a,row:t},a))}),n.jsx(re,{})]})}function le({funct:e=()=>{console.log("Without function")},initial:s}){const[t,a]=d.useState(s||!1),i=()=>{e(),a(r=>!r)};return d.useEffect(()=>{a(s)},[s]),n.jsx("span",{className:`btn-togle br-max d-flex f-center pointer relative ${t?"active":""}`,onClick:i,children:n.jsx("span",{className:`btn-circle d-flex br-50 no-select absolute ${t?"active":""}`})})}function oe(){const[e,s]=d.useState(()=>{const a=localStorage.getItem("F-Theme");return a?a==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),t=()=>{const a=!e;s(a),localStorage.setItem("F-Theme",a?"dark":"light")};return d.useEffect(()=>{document.documentElement.classList[e?"add":"remove"]("dark"),document.documentElement.style.colorScheme=e?"dark":"light"},[e]),d.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)"),i=r=>{localStorage.getItem("F-Theme")||s(r.matches)};return a.addEventListener("change",i),()=>{a.removeEventListener("change",i)}},[]),n.jsx(le,{funct:t,initial:e})}function ce(){return c(l.setting),n.jsxs("div",{className:"f-col g-2 f-center ",children:[n.jsx("h4",{className:"br w-100 pb-2",children:"Appearence setings"}),n.jsx(oe,{}),n.jsx("span",{className:"f-row g-2 f-center",children:"Lifos".split("").map((e,s)=>n.jsx("span",{className:"box-letter d-flex br-6",children:e.toUpperCase()},s))}),n.jsx("span",{className:"mt-3",children:"Under construction..."})]})}function de(){return n.jsxs("div",{className:"f-col g-2 f-center ",children:[n.jsx("h4",{className:"br w-100 pb-2",children:"Languange setings"}),n.jsx("span",{children:"Under construction..."})]})}const ue=e=>{const s=u.inmutable(l.game.get()),t=u.inmutable(l.setting.get());s.valid=Array.from({length:t.tries},()=>Array.from({length:Number(e)},()=>({char:"",isValid:null}))),s.currentLetter=0,s.restart=!0,s.currentRow=0,t.length=Number(e),l.game.set(s),l.setting.set(t),u.set("F-Wordle",{game:s,settings:t,visual:l.visual.get()})},ge=e=>{const s=u.inmutable(l.game.get()),t=u.inmutable(l.setting.get());s.valid=Array.from({length:Number(e)},()=>Array.from({length:t.length},()=>({char:"",isValid:null}))),s.currentLetter=0,s.currentRow=0,t.tries=Number(e),l.game.set(s),l.setting.set(t),u.set("F-Wordle",{game:s,settings:t,visual:l.visual.get()})},me=e=>{},E={setWordLength:ue,setTries:ge,setLanguage:me};function T({min:e=3,max:s=10,initialValue:t=5,funct:a=i=>{console.log("Sin funcion",i)}}){const[i,r]=d.useState(t),o=g=>{const m=g.target.value;r(m),a(m)};return n.jsx("input",{type:"range",min:e,max:s,value:i,onInput:o})}function fe(){const e=c(l.setting),s=c(l.game);return n.jsxs("div",{className:"game-set f-col",children:[n.jsx("h4",{className:"br pb-2",children:"Game settings"}),n.jsx("p",{className:"",children:"Choose and setup the properties of the game."}),n.jsxs("section",{className:"f-row g-4 w-100 mt-4",children:[n.jsxs("div",{className:"f-col g-3 mt-1",style:{minWidth:280},children:[n.jsxs("span",{className:"f-row f-justify-between",children:[n.jsx("label",{className:"fw-600",children:"Word Length"}),n.jsx(T,{min:3,max:10,initialValue:e.length,funct:E.setWordLength})]}),n.jsxs("span",{className:"f-row f-justify-between",children:[n.jsx("label",{className:"fw-600",children:"Number of Tries"}),n.jsx(T,{min:3,max:10,initialValue:e.tries,funct:E.setTries})]})]}),n.jsx("span",{className:"f-col g-2",style:{flexGrow:1},children:s?.valid.map((t,a)=>n.jsx("span",{className:"f-row g-2 br-6 f-justify-center",children:s?.valid[a].map((i,r)=>n.jsx("span",{className:"box-letter d-flex br-6",style:{height:40}},r))},a))})]})]})}function he(){const[e,s]=d.useState("Game"),t=a=>{document.querySelectorAll(".set-options").forEach(r=>{r.classList.remove("active")}),a.target.classList.add("active"),s(a.target.innerText)};return n.jsx("div",{className:"setting-container f-markdown f-col f-center g-2 pt-4 h-100 mx-auto absolute",children:n.jsxs("div",{className:"f-row f-wrap w-70 h-100",children:[n.jsx("aside",{className:"set-aside d-flex g-1 f-justify-end",children:n.jsxs("div",{className:"f-col g-1 h-100 pr-3 w-100",children:[n.jsx("h5",{className:"py-2 fs-4 fw-600 mb-1 mt-3",children:"Settings"}),n.jsx("span",{className:"set-options m-0 ml-1 pointer active",onClick:t,children:"Game"}),n.jsx("span",{className:"set-options m-0 ml-1 pointer",onClick:t,children:"Appearance"}),n.jsx("span",{className:"set-options m-0 ml-1 pointer",onClick:t,children:"Language"})]})}),n.jsx("main",{className:"set-main f-col pl-3 pt-3 f-grow-1",children:e==="Appearance"?n.jsx(ce,{}):e==="Language"?n.jsx(de,{}):e==="Game"?n.jsx(fe,{}):null})]})})}function je(){const e=c(l.navigation);return n.jsxs("section",{className:"wrapper-continer f-col w-100 f-center",children:[n.jsx(ie,{}),e==="setting"?n.jsx(he,{}):null]})}export{je as default};
