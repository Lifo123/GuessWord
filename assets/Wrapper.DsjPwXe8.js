import{a as y,G as o,u,j as a}from"./Buttons.C0uhBAAQ.js";import{r as d}from"./index.YZ_XhM9s.js";import{J as w}from"./_astro-entry_sonner.BrdQ6kbN.js";/* empty css                        */import"./index.CTAGWh-w.js";const E=typeof window<"u",I=y(E?JSON.parse(localStorage.getItem("F-Config")||"{}"):{}),W=y(E&&new URLSearchParams(window.location.search).get("data")||""),x=y({popup:{type:null,delay:null}}),G={Config:I,Params:W},P=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},R=e=>JSON.parse(localStorage.getItem(e)||"{}"),V=e=>{if(!localStorage.getItem(e)){console.log("Storage not found");return}localStorage.removeItem(e)},C=e=>JSON.parse(JSON.stringify(e)),m={set:P,get:R,remove:V,inmutable:C},$=e=>Math.floor(Math.random()*((e||100)+1)),M=(e,t)=>{let n=Array(e.length).fill("false"),s={};e.split("").forEach(r=>{s[r]=(s[r]||0)+1});for(let r=0;r<e.length;r++)t[r]===e[r]&&(n[r]="true",s[t[r]]-=1);for(let r=0;r<e.length;r++)n[r]==="false"&&s[t[r]]>0&&(n[r]="exists",s[t[r]]-=1);const l=n.every(r=>r==="true");return{result:n,isWin:l}},F=(e,t)=>{const n=e.split(":"),s=m.inmutable(t),l=Array.from({length:parseInt(n[1])},()=>Array.from({length:parseInt(n[2])},()=>({char:"",isValid:null})));return s.game.word=n[0],s.game.valid=l,s.settings.tries=parseInt(n[1]),s.settings.length=parseInt(n[2]),s.settings.lang=n[3],s.settings.dictionary=n[4],s},B=(e,t)=>{setTimeout(()=>{if(e==="res"){x.set({popup:{type:null,delay:0}});return}const n=m.inmutable(x.value);n.popup.type=e,n.popup.delay=t,x.set(n)},(t||0)*360)},N={generateRandom:$,compareWord:M,setParams:F,popup:B},p={Local:m,utils:N},S=e=>{(e.endsWith("/")||e.endsWith(","))&&(e=e.slice(0,-1));let t=e.split("/").filter(n=>n!=="");if(t.length===0)throw new Error("Invalid Path: No Path encounter");return t=t.map(n=>n.replace(/^[^a-zA-Z0-9-_\,]+|[^a-zA-Z0-9-_\,]+$/g,"")),t},D=(e,t)=>{if(Array.isArray(t))throw new Error("Invalid Format: The object is an array");const n=S(e);for(let l=0;l<n.length-1;l++)if(n[l].includes(","))throw new Error("Invalid Path: The path contains a comma");let s=n[n.length-1];return{Navigation:n,firstPath:n[0],lastPath:s,lastValues:s.split(",")}},j={normalizePath:S,validatePath:D},O=(e,t)=>{const n=j.validatePath(e,t);if(n.lastValues.length>1)throw new Error("The last path expect a single value.");if(n.Navigation.length===1)return t[n.firstPath];let s=t;for(let r=0;r<n.Navigation.length-1;r++){const i=n.Navigation[r];if(!s[i])return;s=s[i]}const l=n.lastPath[0];if(s[l]!==void 0)return s[l]},U=(e,{value:t,data:n})=>{if(t===n)throw new Error("The value and data cannot be the same.");const s=j.validatePath(e,n),l=s.lastValues.length>1;let r=isNaN(Number(s.firstPath))?{...n}:[];if(s.Navigation.length===1)return r[s.firstPath]=t,r;if(!Array.isArray(t)&&s.lastValues.length>1)throw new Error(`The value expects an Array with ${s.lastValues.length} values.`);let i=r,c=i;for(let f=0;f<s.Navigation.length;f++){const g=s.Navigation[f];if(f===s.Navigation.length-1){if(!Array.isArray(t)&&l)throw new Error("The value must be an array when assigning to multiple keys.");if(s.lastValues.length===1){i[g]=t;break}return c=i,s.lastValues.forEach((L,k)=>{c[L]=t[k]}),r}i[g]===void 0&&(i[g]={}),c=i,i=i[g]}return r},J=(e,t)=>{const n=j.validatePath(e,t);let s={...t};if(n.Navigation.length===1){const{[n.firstPath]:r,...i}=t;return i}let l=t;for(let r=0;r<n.Navigation.length;r++){const i=n.Navigation[r];if(!l[i])return console.log("No existe"),t;if(r===n.Navigation.length-1){delete l[i];break}l=l[i]}return s},K=()=>{console.log("hi")},Y=()=>{console.log("goodbye")},T={get:O,set:U,remove:J,sayHello:K,sayGoodbye:Y},q=e=>{const t=m.inmutable(o.game.get());if(t?.restart)return;const n=t.currentLetter,s=t.currentRow;if(n>=t.valid[0].length)return;let l=T.set(`valid/${s}/${n}/char`,{value:e,data:t});l.currentLetter=n+1,o.game.set(l)},z=()=>{const e=m.inmutable(o.game.get());if(e?.restart)return;const t=e.currentLetter,n=e.currentRow;if(t<=0)return;let s=T.set(`valid/${n}/${t-1}/char`,{value:"",data:e});s.currentLetter=t-1,o.game.set(s)},H=()=>{let e=m.inmutable(o.game.get());if(e?.restart)return;const t=e.currentLetter,n=e.currentRow;if(t<e.valid[0].length){const r=document.querySelector(`[data-row="${n}"]`);r?.classList.add("error"),w.error("Field is not complete"),setTimeout(()=>{r?.classList.remove("error")},400);return}w.dismiss();const s=e.valid[n].map(r=>r.char).join(""),l=p.utils.compareWord(e.word,s);for(let r=0;r<e.valid[n].length;r++)e.valid[n][r].isValid=l.result[r];e.currentRow=n+1,e.currentLetter=0,e.isWin=l?.isWin?l?.isWin:null,e.currentRow===e.valid.length&&e.isWin===null&&(e.isWin=!1,N.popup("lose",e.valid.length),setTimeout(()=>{w(e.word,{duration:1500})},e.valid.length*150)),e.isWin&&N.popup("win",e.valid.length+1),o.game.set(e),p.Local.set("F-Wordle",{game:e,settings:o.setting.get(),visual:o.visual.get()})},h={typing:q,backspace:z,enter:H};function Z(){const e=u(o.game),t=u(o.setting);u(o.visual);const n=u(G.Params),s=async()=>{let i=p.Local.get("F-Wordle"),c=o.initialData;if(n){c=p.utils.setParams(n,c),o.game.set(c.game),o.setting.set(c.settings),p.Local.set("F-Wordle",c);return}i?.game?.word||l()},l=()=>{let i=p.Local.inmutable(o.initialData);const c=fetch("https://app-eqlfk354ea-uc.a.run.app/word/").then(g=>g.json()).then(g=>{i.game.word=g,i.game.restart=!1,i.game.isWin=null,i.game.valid=Array(t.tries).fill(Array(t.length).fill({char:"",isValid:null})),i.settings.tries=t.tries,N.popup("res"),o.game.set(i.game),p.Local.set("F-Wordle",i)});w.promise(c,{loading:"Cargando...",error:"Error al cargar la palabra"}),document.querySelectorAll("[data-char]").forEach(g=>{g.removeAttribute("data-valid")})},r=i=>{/^[a-zA-ZñÑ]$/.test(i.key)&&h.typing(i.key),i.key==="Backspace"&&h.backspace(),i.key==="Enter"&&h.enter()};return d.useEffect(()=>(e?.isWin||e?.currentRow===e?.valid.length||e?.restart?window?.removeEventListener("keydown",r):window?.addEventListener("keydown",r),()=>{window?.removeEventListener("keydown",r)}),[e?.isWin,e?.restart]),d.useEffect(()=>{s()},[]),{getWord:s,restartGame:l}}function _({data:e,id:t}){const n=u(o.game),s=d.useRef(null);return d.useEffect(()=>{e.isValid!==null?(s?.current?.removeAttribute("data-valid"),s?.current?.removeAttribute("data-win"),s?.current?.classList.remove("active"),setTimeout(()=>{s?.current?.classList.add("validate"),setTimeout(()=>{s.current?.setAttribute("data-valid",e.isValid),n.isWin&&setTimeout(()=>{s.current?.setAttribute("data-win","true")},(n?.valid[0].length+1)*60)},180)},t*210)):(s.current?.classList.remove("validate"),s.current?.removeAttribute("data-valid"),s.current?.removeAttribute("data-win"))},[e.isValid,e.char]),a.jsx("span",{className:`box-letter ${e.char?"active":""}`,ref:s,children:e?.char?.toUpperCase()||""})}function Q({row:e=[],id:t}){return a.jsx("div",{className:"game-row f-row g-2 f-center","data-row":t,children:e?.map((n,s)=>a.jsx(_,{data:n,id:s},`${n.char}-${s}`))})}function X(){return a.jsx("div",{className:"stadistic-container br-4 f-col p-2 w-100",children:"Stadistic"})}function ee({funct:e=()=>console.log("Sin funcion")}){const[t,n]=d.useState(!1),s=u(o.game),{popup:l}=u(x),r=s.isWin,i={title:r?"!Felicidades!":"!Perdiste!",desc:r?"Has ganado la palabra":"No has ganado la palabra",btntext:r?"Jugar de nuevo":"Volver a intentarlo",btnsec:r,delay:l?.delay||(s.valid[0]?.length+1)*360,cont:r?a.jsx(X,{}):null};return d.useEffect(()=>{if(r||!r){const c=setTimeout(()=>{n(!0)},i.delay);return()=>clearTimeout(c)}},[r,i.delay]),t?a.jsx("div",{className:"obscure absolute h-100 w-100 d-flex fixed",children:a.jsx("div",{className:"wrapper-play-again absolute d-flex f-justify-center",children:a.jsxs("div",{className:"play-again-container f-col g-2 br-10 px-3 py-4 f-align-center",children:[a.jsx("h1",{children:i.title}),a.jsx("p",{children:i.desc}),i.cont&&a.jsx("div",{className:"f-col g-2 w-100 f-center",children:i.cont}),a.jsxs("div",{className:"f-row g-2 w-100 f-center",children:[a.jsx("span",{className:"btn btn-green br-6 d-flex f-center",onClick:e,children:i.btntext}),i.btnsec&&a.jsx("span",{className:"btn btn-blue br-6 d-flex f-center",children:"Compartir"})]})]})})}):null}function te(){return a.jsx("span",{className:"icon",children:a.jsx("svg",{width:"28",height:"28",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",style:{rotate:"-90deg",transform:"translate(0px, -2px)"},children:a.jsx("path",{d:"m10 11.5 4 4m0-4-4 4M6.133 21C4.955 21 4 20.02 4 18.81v-8.802c0-.665.295-1.295.8-1.71l5.867-4.818a2.09 2.09 0 0 1 2.666 0l5.866 4.818c.506.415.801 1.045.801 1.71v8.802c0 1.21-.955 2.19-2.133 2.19z"})})})}function ne(){const e=u(o.game);return d.useEffect(()=>{e.currentRow>0&&e.currentRow<=e.valid.length&&setTimeout(()=>{for(let t=0;t<e.currentRow;t++)e.valid[t].forEach((s,l)=>{const r=document.querySelector(`[data-char="${s.char.toUpperCase()}"]`);r?.getAttribute("data-valid")!=="true"&&r?.setAttribute("data-valid",s.isValid)})},e.valid[0].length*260)},[e.currentRow]),a.jsxs("section",{className:"keyboard-container f-col g-2 mt-4",children:[a.jsx("div",{className:"f-row g-2",children:"QWERTYUIOP".split("").map((t,n)=>a.jsx(v,{char:t,funct:()=>h.typing(t)},n))}),a.jsx("div",{className:"f-row g-2",children:"ASDFGHJKL".split("").map((t,n)=>a.jsx(v,{char:t,funct:()=>h.typing(t)},n))}),a.jsxs("div",{className:"f-row g-2",children:[a.jsx(v,{char:"Enviar",className:"px-5",funct:()=>h.enter()}),"ZXCVBNM".split("").map((t,n)=>a.jsx(v,{char:t,funct:()=>h.typing(t)},n)),a.jsx(v,{className:"px-4",char:a.jsx(te,{}),funct:()=>h.backspace()})]})]})}const v=e=>a.jsx("span",{className:`keyboard-box pointer d-flex f-center br-4 ${e.className||""}`,style:e.style,onClick:e.funct,"data-char":e.char,children:e.char});function se(){const e=u(o.game);u(o.setting),u(x);const t=Z();return a.jsxs("div",{className:"board f-col g-2 f-center h-100 w-100 relative pb-5",children:[e?.isWin!==null?a.jsx(ee,{funct:t.restartGame}):null,a.jsx("div",{className:"board-cont f-col g-2",children:e?.valid?.map((n,s)=>a.jsx(Q,{id:s,row:n},s))}),a.jsx(ne,{})]})}function ae({funct:e=()=>{console.log("Without function")},initial:t}){const[n,s]=d.useState(t||!1),l=()=>{e(),s(r=>!r)};return d.useEffect(()=>{s(t)},[t]),a.jsx("span",{className:`btn-togle br-max d-flex f-center pointer relative ${n?"active":""}`,onClick:l,children:a.jsx("span",{className:`btn-circle d-flex br-50 no-select absolute ${n?"active":""}`})})}function re(){const[e,t]=d.useState(()=>{const s=localStorage.getItem("F-Theme");return s?s==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),n=()=>{const s=!e;t(s),localStorage.setItem("F-Theme",s?"dark":"light")};return d.useEffect(()=>{document.documentElement.classList[e?"add":"remove"]("dark"),document.documentElement.style.colorScheme=e?"dark":"light"},[e]),d.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),l=r=>{localStorage.getItem("F-Theme")||t(r.matches)};return s.addEventListener("change",l),()=>{s.removeEventListener("change",l)}},[]),a.jsx(ae,{funct:n,initial:e})}function ie(){return u(o.setting),a.jsxs("div",{className:"f-col g-2 f-center ",children:[a.jsx("h4",{className:"br w-100 pb-2",children:"Appearence setings"}),a.jsx(re,{}),a.jsx("span",{className:"f-row g-2 f-center",children:"Lifos".split("").map((e,t)=>a.jsx("span",{className:"box-letter d-flex br-6",children:e.toUpperCase()},t))}),a.jsx("span",{className:"mt-3",children:"Under construction..."})]})}function le(){return a.jsxs("div",{className:"f-col g-2 f-center ",children:[a.jsx("h4",{className:"br w-100 pb-2",children:"Languange setings"}),a.jsx("span",{children:"Under construction..."})]})}const oe=e=>{const t=m.inmutable(o.game.get()),n=m.inmutable(o.setting.get());t.valid=Array.from({length:n.tries},()=>Array.from({length:Number(e)},()=>({char:"",isValid:null}))),t.currentLetter=0,t.restart=!0,t.currentRow=0,n.length=Number(e),o.game.set(t),o.setting.set(n),m.set("F-Wordle",{game:t,settings:n,visual:o.visual.get()})},ce=e=>{const t=m.inmutable(o.game.get()),n=m.inmutable(o.setting.get());t.valid=Array.from({length:Number(e)},()=>Array.from({length:n.length},()=>({char:"",isValid:null}))),t.currentLetter=0,t.currentRow=0,n.tries=Number(e),o.game.set(t),o.setting.set(n),m.set("F-Wordle",{game:t,settings:n,visual:o.visual.get()})},ue=e=>{},b={setWordLength:oe,setTries:ce,setLanguage:ue};function A({min:e=3,max:t=10,initialValue:n=5,funct:s=l=>{console.log("Sin funcion",l)}}){const[l,r]=d.useState(n),i=c=>{const f=c.target.value;r(f),s(f)};return a.jsx("input",{type:"range",min:e,max:t,value:l,onInput:i})}function de(){const e=u(o.setting),t=u(o.game);return a.jsxs("div",{className:"game-set f-col",children:[a.jsx("h4",{className:"br pb-2",children:"Game settings"}),a.jsx("p",{className:"",children:"Choose and setup the properties of the game."}),a.jsxs("section",{className:"f-row g-4 w-100 mt-4",children:[a.jsxs("div",{className:"f-col g-3 mt-1",style:{minWidth:280},children:[a.jsxs("span",{className:"f-row f-justify-between",children:[a.jsx("label",{className:"fw-600",children:"Word Length"}),a.jsx(A,{min:3,max:10,initialValue:e.length,funct:b.setWordLength})]}),a.jsxs("span",{className:"f-row f-justify-between",children:[a.jsx("label",{className:"fw-600",children:"Number of Tries"}),a.jsx(A,{min:3,max:10,initialValue:e.tries,funct:b.setTries})]})]}),a.jsx("span",{className:"f-col g-2",style:{flexGrow:1},children:t?.valid.map((n,s)=>a.jsx("span",{className:"f-row g-2 br-6 f-justify-center",children:t?.valid[s].map((l,r)=>a.jsx("span",{className:"box-letter d-flex br-6",style:{height:40}},r))},s))})]})]})}function me(){const[e,t]=d.useState("Game"),n=s=>{document.querySelectorAll(".set-options").forEach(r=>{r.classList.remove("active")}),s.target.classList.add("active"),t(s.target.innerText)};return a.jsx("div",{className:"setting-container f-markdown f-col f-center g-2 pt-4 h-100 mx-auto absolute",children:a.jsxs("div",{className:"f-row f-wrap w-70 h-100",children:[a.jsx("aside",{className:"set-aside d-flex g-1 f-justify-end",children:a.jsxs("div",{className:"f-col g-1 h-100 pr-3 w-100",children:[a.jsx("h5",{className:"py-2 fs-4 fw-600 mb-1 mt-3",children:"Settings"}),a.jsx("span",{className:"set-options m-0 ml-1 pointer active",onClick:n,children:"Game"}),a.jsx("span",{className:"set-options m-0 ml-1 pointer",onClick:n,children:"Appearance"}),a.jsx("span",{className:"set-options m-0 ml-1 pointer",onClick:n,children:"Language"})]})}),a.jsx("main",{className:"set-main f-col pl-3 pt-3 f-grow-1",children:e==="Appearance"?a.jsx(ie,{}):e==="Language"?a.jsx(le,{}):e==="Game"?a.jsx(de,{}):null})]})})}function we(){const e=u(o.navigation);return a.jsxs("section",{className:"wrapper-continer f-col w-100 f-center",children:[a.jsx(se,{}),e==="setting"?a.jsx(me,{}):null]})}export{we as default};
